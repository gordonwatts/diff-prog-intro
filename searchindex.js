Search.setIndex({docnames:["basic","cut_then_nn","different_cut_emulations","dumb_data_source","intro","jax","jax_optimization","ml_loss","using_nn"],envversion:{"sphinx.domains.c":2,"sphinx.domains.changeset":1,"sphinx.domains.citation":1,"sphinx.domains.cpp":5,"sphinx.domains.index":1,"sphinx.domains.javascript":2,"sphinx.domains.math":2,"sphinx.domains.python":3,"sphinx.domains.rst":2,"sphinx.domains.std":2,"sphinx.ext.intersphinx":1,sphinx:56},filenames:["basic.ipynb","cut_then_nn.ipynb","different_cut_emulations.ipynb","dumb_data_source.ipynb","intro.md","jax.ipynb","jax_optimization.ipynb","ml_loss.ipynb","using_nn.ipynb"],objects:{},objnames:{},objtypes:{},terms:{"0":[0,1,2,3,5,6,7,8],"00":1,"000124676":[],"000176179":[],"0002":1,"000223244":2,"000247079":[],"000314067":2,"000343248":[],"000452738":[],"0005":7,"000504125":2,"000659615":2,"000777305":2,"00204708":2,"00258652":2,"00280579":[],"00361745":2,"00365033":2,"00399e":2,"00450082":[],"00512057":2,"00546376":[],"00665744":[],"00712623":2,"00814901":[],"00981836":2,"0100272":[],"0103967":2,"01308e":[],"0133153":[],"01523":2,"01843e":2,"0202648":2,"0226232":2,"0273771":2,"0294":2,"03":1,"0318627":2,"0332585":2,"04":[],"0406046":2,"0414378":2,"0424349":2,"04523e":2,"0486632":[],"0498758":2,"05":2,"0540514":1,"054826":2,"0582":2,"06":[1,2,6,8],"0679395":2,"07":[],"07146e":2,"0795874":2,"08":2,"0856":[],"0888767":2,"1":[0,1,2,3,5,6,7,8],"10":[0,1,2,5,6,7,8],"100":[0,1,2,3,5,6,7,8],"1000":[1,8],"101":1,"1058":[],"10k":1,"11":[],"112929":1,"119":[],"12":[],"1200":8,"12000":1,"1234":[1,8],"1400":8,"14167e":[],"15":[1,2,8],"1521e":[],"15567e":2,"16":2,"1600":8,"16000":1,"1677":2,"1680":[],"17":2,"18":2,"1800":8,"19":[],"1905":[],"1d":[0,2,5],"1e":2,"2":[0,1,2,3,5,6,7,8],"20":[3,5,6],"200":[1,8],"2000":[1,8],"20000":1,"2082":7,"2099":2,"20k":1,"2147":[],"2192":[],"22":[0,1,5,8],"2288":2,"23":2,"23895e":[],"24000":1,"2407":[],"25":[1,8],"25000":1,"2543":2,"26":7,"26034e":2,"2678":[],"28":2,"28000":1,"2814":2,"29":2,"2912":2,"2d":[1,8],"3":[0,1,2,5,6,7,8],"30":[1,8],"300":1,"305704":2,"30805e":[],"3085":2,"30k":8,"31":[1,2,8],"3100":2,"32":[],"32000":1,"33":2,"3397":2,"34":1,"35":[],"3521":[],"36":2,"36000":1,"38":1,"39066e":2,"4":[0,1,2,3,5,6],"40":[1,3],"400":[1,8],"4000":1,"40000":[1,8],"40k":1,"41":1,"42":2,"42214":2,"439092":8,"439217":8,"439316":8,"439461":8,"439498":8,"439545":1,"439553":1,"439556":8,"439573":1,"439608":1,"439668":1,"439681":8,"439773":1,"439911":8,"439975":1,"43999e":2,"44":[0,1,5],"440081":8,"440314":1,"440696":8,"440938":1,"442189":1,"4429":2,"448803":1,"448879":1,"448972":1,"449082":1,"449200":1,"449205":1,"449336":1,"449472":1,"449610":1,"449746":1,"449880":1,"45":[1,6],"450008":1,"450086":8,"47":8,"4857":[],"5":[1,2,3,6,8],"50":[1,6,7,8],"500":[1,8],"51615274":1,"52":[],"5308":2,"5322":2,"535":5,"545":[],"55":[],"5703":2,"58265e":2,"5828":[],"58401":[],"58485e":[],"5877":2,"6":[1,2,8],"600":[1,8],"60402e":[],"6042":2,"60752e":[],"61":2,"6187":[],"62":[7,8],"624483346939087":6,"635":[],"64088e":[],"6516":2,"6565423":1,"66":1,"669":2,"6736":2,"67674":2,"681":[],"69":[1,8],"7":1,"70":[1,8],"700":1,"702":[],"71298":2,"7188":[],"72":[1,8],"73":2,"7369":2,"737":[0,5],"74":0,"7412e":2,"75":1,"7523":[],"76":2,"763":[],"77":[],"77184e":[],"7731":2,"77402":[],"78":[1,2],"7921":[],"7925":2,"8":0,"80":[1,8],"800":[1,8],"8000":1,"80835e":[],"81":2,"815":[],"83":2,"8525":[],"857177734375":7,"858":[],"87915e":2,"88":5,"89632797241211":6,"9":[1,2,8],"90":[0,7],"900":1,"9308":2,"936":[],"94":1,"9481":2,"96212e":[],"97":8,"97507":2,"979":[],"9854":[],"99837e":2,"case":[1,3],"class":1,"default":2,"do":[0,1,2,3,4,5,7,8],"final":[0,1,2,3,6,7],"float":[0,1,2,3,5,6,7],"function":[1,4,6],"import":[0,1,2,3,5,6,7,8],"long":1,"new":[1,6,7],"return":[0,1,2,3,5,6,7,8],"short":[1,5],"super":1,"try":[1,3,4,5],"while":2,A:[0,2,7],And:[1,2,5,8],As:[1,2,3,8],At:[1,5],But:3,By:2,For:3,If:1,In:[1,3,5,7,8],It:[0,1,3],No:[1,2,3,5,6,7,8],Not:5,One:3,That:[1,2,3,5],The:[1,2,3,4,5,7,8],Then:3,There:3,To:[3,8],With:8,_:[1,3,5,6,7,8],__call__:1,__init__:1,_cut:[3,7],_initial_cut:1,_layer:1,ab:2,abl:5,about:[1,2,3,4,5,8],abov:[1,2,3,5],absl:[1,2,3,5,6,7,8],accuraci:2,across:2,actual:[1,2,3,4],ad:[2,4],adam:[1,8],add:[1,5,8],affect:2,after:3,against:2,algorithm:[1,6],align:3,all:[1,3,7],all_data:[1,8],all_truth:[1,8],allow:1,along:[1,3],alpha:[0,1,8],also:[1,2,3,8],alter:2,alwai:3,amount:3,an:[2,4,5],analysi:3,ani:[1,6],answer:7,anyth:[0,3],apart:1,appear:1,append:[6,7],appli:[1,3,8],apply_wt:5,approach:2,ar:[0,1,2,3,4,5,6],aren:7,arg:2,argmax:[0,5],around:[1,3,4,5,6],arrai:[0,2,3,5,6,7],asarrai:[1,3,5,8],ask:3,aspect:3,assert:1,assum:3,astyp:[1,8],auto:[3,4],automat:3,averag:2,avoid:8,awai:[1,2],ax1:[6,7],ax2:[6,7],axhlin:[1,2,3,5,6,7],axi:[1,6,7],axvlin:[0,1,5,7],b:[0,2,4,5,6,7],back:[0,1,2,3,5,6,7,8],back_j:2,background:[0,1,2,3,4,7,8],background_data:[1,8],bad:[1,8],bad_data:[1,8],basic:[1,2,4,6],becaus:[1,2],been:[2,8],befor:[1,2,3],behav:[2,5,6,7],behavior:[2,8],below:[1,2,3,8],best:[2,8],better:[2,3,5,6,7],beyond:[1,2],big:7,bin:[0,1,8],binari:2,bit:[1,3,6,8],black:[2,5,6,7],blown:3,blue:[6,7],book:4,both:[1,2,3,5],bottom:5,bring:1,broad:[2,4],brute:4,buffer:3,bulk:1,bunch:4,c:[0,1,2,5,6,7],calc_by_c:2,calc_valu:1,calcul:[0,1,2,3,5],call:[1,2],callabl:2,can:[1,2,3,5,6,8],cannot:2,carefulli:[1,7],caus:2,cell:2,central:3,chang:1,chapter:[0,1,2,3,7,8],characterist:[2,5],check:1,choos:[1,7],circl:8,circumst:1,classif:7,classifi:[1,8],client:3,close:[2,7],cm:[1,8],cmap:[1,8],code:[1,2,6,8],color:[0,1,2,3,5,6,7,8],combin:[1,7],comment:4,compar:[1,3,4],comparison:1,complet:7,compon:1,concat:1,concaten:[7,8],concatin:1,conclus:3,construct:[0,4],contain:[2,5],contour:[1,8],convert:5,correct:[1,8],could:[1,3,8],count:[1,6,7,8],cours:2,cpu:[1,2,3,5,6,7,8],creat:[0,7],cross:[2,3],ctor:1,current:[3,7],curv:6,cut:[0,3,4,5,6,7,8],cut_data:3,cut_erf:2,cut_loss:[1,7],cut_nam:2,cut_range_valu:1,cut_sigmoid:2,cut_valu:[0,1,3,5,6,7],cuts_initi:1,d:[1,7],d_erf_sig_sqrt_b:5,d_erf_valu:3,d_loss:3,d_my_erf:3,d_sig_sqrt_b:5,dash:[2,5,6,7],data:[1,2,4,5,8],data_back:[0,1,5,7,8],data_back_j:[2,5],data_max:2,data_min:2,data_sig:[0,5,7],data_sig_j:[2,5],dataset:[3,8],deal:[3,6],decent:[1,4],def:[0,1,2,3,5,6,7,8],defin:[2,8],delta:[3,5],depend:[1,7],deriv:[1,2,5],descent:4,design:5,determin:[1,7],develop:2,devicearrai:1,dict:2,did:7,diff:[3,4],differ:[1,2],differenti:[0,3],direct:2,directli:1,discov:2,discuss:1,displac:0,distanc:7,distinct:3,distribut:[0,3],do_sig_b_inf:1,doe:[2,4,5,6],doesn:[1,6],don:[2,4],done:[1,6,8],down:[1,4],drawn:0,driven:2,dtyp:1,dtype:1,dumb:3,dure:[2,3,7],e:3,each:[1,6],earlier:1,easi:1,effect:1,effici:1,either:[1,5],electron:3,element:1,els:1,emit:2,end:[1,7],enough:5,entropi:2,entropy_back:2,entropy_sig:2,epoch:[1,3,8],erf:[1,2,5,7,8],erf_max_valu:5,erf_s_sqrt_b:5,erf_sig_sqrt_b:5,erf_valu:3,erf_window_mask:3,error:[1,3],etc:6,evalu:[1,6],even:[1,3],everi:6,everyth:[1,3],exact:[5,6],exactli:[1,2,5],exampl:3,execut:3,exp:2,expect:1,experi:7,explor:[2,5],exponenti:[2,3],extend:[1,8],extent:[1,8],f:[0,1,2,6,7],f_metric:2,fact:[1,2,3,5],fall:[1,2,3,5,6,7,8],fals:[2,5],far:[1,2],fascin:1,feedforward:[1,8],few:2,fig:[6,7],figur:4,file:2,find:[5,6],fine:1,first:[1,2,5,8],fit:3,flat:1,float32:[1,8],follow:1,forc:4,forward:[0,1],found:[1,2,3,5,6,7,8],from:[0,1,2,3,5,6,7,8],front:[4,8],ft:2,full:[1,3,8],full_loss:3,func:2,functool:2,further:1,g:[2,3],g_valu:[2,6,7],gaussian:0,gener:1,get:[1,2,3,7,8],get_paramet:1,gev:3,github:4,given:1,go:[1,2,3,5,6,8],goal:8,good:[1,2,5,8],good_data:[1,8],gotcha:5,gpu:[1,2,3,5,6,7,8],grad:[2,3,5,6,7],gradhep:2,gradient:[1,2,3,4],graphic:[1,8],green:[0,1,3,5,7,8],grind:1,guess:2,ha:[1,3,5,7,8],had:[1,2],hadn:1,haiku:[1,8],half:3,halt:1,hand:1,handl:4,happen:[1,3],hard:[4,8],harder:7,have:[1,2,3,4,5,6,7,8],head:1,header:2,heck:5,help:6,hep:3,here:[1,2,3,5,6],hist2d:[1,8],hist:[0,1,8],hit:1,hk:[1,8],hl:3,how:[1,3,4,5,7],howev:[1,2,4,7],html:2,i:[0,1,2,4,8],i_background:1,i_sign:1,idea:6,ident:1,implement:[1,3,4,8],implic:2,incorrect:1,increas:1,individu:1,infer:[1,3,8],infer_b_mlp:1,infer_b_sel:1,infer_background:[1,8],infer_s_mlp:1,infer_s_sel:1,infer_sign:[1,8],infin:[1,2],info:[1,2,3,5,6,7,8],infrastructur:1,init:1,initi:1,initial_cut:1,input:1,instead:7,interact:3,interest:[0,1,3,8],ion:[0,1,3,5,6,7,8],iri:3,isn:[3,5],issu:[1,8],item:2,iter:[1,6,7],its:[1,2,3],itself:[2,3],jax:[1,2,3,4,6,7,8],jax_cut:2,jax_help:[1,2,3,6,7,8],jnp:[1,2,3,5,6,7,8],just:[1,3,6,7,8],keep:[0,1,8],kei:[1,8],know:[1,3,4],knowledg:1,l:7,label:[0,1,2,6,7,8],labelcolor:[6,7],lambda:1,laptop:1,larg:3,last:[1,2,3],lastli:5,later:2,lax:[1,2,5],layer:[1,3,8],layer_output:1,lazi:1,lbl:1,learn:[1,3,4,6,7],learning_r:[1,6,7],left:2,legend:[0,1,2,8],len:[0,1,3,7,8],let:[0,1,2,3,5,6,7,8],level:[1,8],lhc:3,librari:2,like:[1,3,4,6,8],likelihood:[6,7],limit:[5,6],line:[2,3,5],linestyl:[2,5,6,7],linewidth:[1,8],linspac:[0,1,2,3,5,6,7],list:[1,2],littl:5,live:1,ll:[1,2,8],load:[1,3,8],loadtxt:3,local:[2,6],locat:[2,8],log:[1,2,3,7,8],longer:2,look:[0,1,2,3,4,5,6,7],loop:[1,4],loss:[1,2,3,4,6],loss_sig_sqrt_b:2,loss_squar:2,loss_x_entropi:2,lot:[1,3],low:1,lower:5,lower_limit:2,m:[1,4],made:1,magic:[0,2],mai:[1,2,3,5],make:[0,1,2,3,4,7,8],mask:3,masked_loss:3,masked_loss_deriv:3,masked_training_data:3,masked_training_truth:3,match:[3,5],math:0,matplotlib:[0,1,2,3,5,6,7,8],matter:1,max:[0,2,5],max_index:[0,5,7],maximum:6,me:4,mean:[1,2,3],meant:[1,8],measur:2,median:1,memori:3,method:[0,1,5],metric:2,mi:1,might:[1,2,3,4,6,8],min:2,mind:0,minim:[2,3,8],minima:6,minimum:2,minimz:1,minut:1,misclassifi:[1,8],ml:[2,4],mlp:8,model:[1,8],model_mlp_onli:1,model_selection_onli:1,modifi:5,modul:8,moduleconcat:1,more:[1,2,3,4,5,6,7,8],most:1,move:[1,3,4,8],much:[3,4,7],multipli:1,multiply:1,multiplyrow:1,multivariate_norm:[1,8],must:3,my_erf:3,myself:4,n:[1,7],n_sig:0,name:[1,2,8],narrow:2,need:[1,4,5,6,8],neg:1,neglogloss:[1,8],net:[1,8],next:[0,1,2,7,8],nice:2,nn:4,non:3,none:1,nope:5,normal:[7,8],note:[1,2,3,5],notebook:1,noth:[1,3],now:[1,2,5,6,7],np:[0,2,3],number:1,numpi:[0,1,2,3,4,5,6,7,8],observ:1,occur:[0,2,5],odd:1,off:[1,2,5],offset:8,often:3,ok:6,old:1,onc:6,one:[1,3,5,6,7],ones:[1,7,8],onli:[1,3],open:7,oper:[1,4],optax:[1,8],optim:[0,1,4,7,8],option:[1,2],orang:[6,7],order:[1,6,7],other:[0,1,2],otherwis:1,our:[1,2,3,5,6,7],ourselv:2,out:[1,2,3,4,5,6,7],output:[1,2],output_s:[1,8],outsid:1,over:1,overlap:8,own:1,p:1,p_t:3,page:3,parallel:1,param:[1,8],paramet:1,part:[1,3],partial:2,pass_back:0,past:1,pattern:1,peak:2,perform:[1,3,7],perhap:[3,5],physic:2,pick:1,pipe:3,place:[2,5,6],plain:1,plateau:1,plot:[0,1,2,3,5,6,7,8],plot_avg_weight:2,plot_contour:[1,8],plot_grad:2,plot_grad_multi:2,plot_in_and_out:1,plot_infer:[1,8],plot_it:1,plot_loss:2,plot_pr:8,plot_s_sqrt_b:[],plot_s_sqrt_b_multi:2,plot_x_entropi:[],plt:[0,1,2,3,5,6,7,8],pm:3,point:[3,5,7],possibl:5,pred:[1,8],predic:4,predict:[1,3,7,8],previou:1,previous:7,print:[0,1,2,5,6,7],prngkei:[1,8],probabl:5,problem:[1,2,4,5],prod:1,program:3,project:3,prop:2,proper:1,properli:1,pull:[3,4],pump:3,push:[1,2,4],put:1,py:2,pyplot:[0,1,2,3,5,6,7,8],quit:8,r:[0,1,2,3,4,5,6,7],rainbow:[1,8],random:[1,7,8],rang:[0,1,6,7,8],rapidli:3,rate:6,rather:[1,7],raw:1,re:[2,6,8],reach:1,read:[3,4],real:[2,7],realiti:1,realli:[1,3,4],reason:[1,6],reconstruct:3,red:[1,8],reduc:3,reject:1,relax:2,reli:6,rememb:1,repeat:7,replac:4,repo:[2,4],request:[3,4],requir:[1,3],rerun:[1,2,3,5,6,7,8],resort:2,rest:7,result:[1,2,3,8],rf:[0,5],right:[1,2,3,5],rightarrow:3,rise:2,rotat:[0,7],row:1,run:[2,5,6,7],run_ev:1,s:[0,1,2,4,5,6,7],s_sqrt_b:[0,5,7],sadli:6,sai:[1,3],said:2,same:[1,2,5,7,8],sampl:[0,1,5,7,8],save:3,scale:0,scan:0,scatter:[1,8],scheme:3,search:5,see:[1,2,5,7,8],seed:3,seem:[2,3],seen:[1,2],select:[0,3,4,8],select_model:1,select_param:1,selectioncut:1,self:1,sens:0,separ:[1,8],servicex:3,set:[1,2,3,5,6,7,8],set_ylabel:[6,7],setup:2,shape:1,shift:1,ship:3,should:1,show:[0,1,2,3,5,6,7,8],shown:[1,8],shp:1,side:3,sig:[0,2],sig_avg:[1,7,8],sig_j:2,sig_sqrt_b:[0,5,6],sig_width:[1,7,8],sigmoid:[1,8],signal:[0,1,2,3,4,7],signal_data:[1,8],significantli:3,similar:[1,2],simpl:[1,4,5,6,7],simpler:[3,8],simpli:6,simplist:6,simul:5,singl:[1,4],sit:[1,2],situat:2,size:[7,8],slightli:[2,5],slope:2,slower:1,small:[3,8],smarter:3,so:[0,1,2,3,4,6,7],softmax_cross_entropi:1,solut:3,solv:[0,3,4],some:[1,2,5],someth:[3,5],somewher:1,sort:4,sourc:2,specifi:1,split:[1,8],spot:1,sqrt:[0,2,4,5,6,7],squar:[1,2,5],squeez:[1,8],standard:[1,2,4,7],start:[1,2,3,5,6,7],state:1,statement:6,step:[3,4],str:2,stradegi:1,straight:1,stroke:4,stumbl:2,subplot:[6,7],substanti:8,subsystem:3,suffer:2,suggest:1,sum:[2,5,7],summari:1,suspect:8,sx:3,system:[3,4],t:[1,2,3,4,5,6,7],tablefmt:2,tabul:2,take:[1,2,4,5],taken:1,talk:4,teach:4,test:[3,8],test_pr:[1,8],testing_background:[1,8],testing_sign:[1,8],text:[0,7],textrm:1,tf_cpp_min_log_level:[1,2,3,5,6,7,8],than:[1,2,7,8],thei:[1,2,3],them:1,thi:[0,1,2,3,4,5,6,7,8],thing:[2,3,6],think:[0,1],those:2,though:2,three:2,through:3,thu:3,tick_param:[6,7],time:[1,2,6,8],titl:[1,2,8],togeth:[1,3],too:[2,3,8],tool:[2,4],tougher:3,toward:[1,2],tpu:[1,2,3,5,6,7,8],track:7,tradit:7,trail:2,train:[2,6,7],trained_cut_valu:1,training_data:[1,3,7,8],training_truth:[1,3,7,8],transform:[1,8],transpos:[1,8],trend:1,tri:1,triangl:8,tricki:1,truth:[1,8],tune:5,tupl:1,turn:[1,5],twinx:[6,7],two:[0,1,2,3,5],type:[1,2],undefin:5,under:1,understand:[3,4],underwai:3,up:[1,2,3,5,6,8],update_cut:[6,7],upper:5,upper_limit:2,us:[1,2,3,4,6,8],util:2,util_nb:2,v:[1,3],valu:[0,1,2,3,5,6,7,8],ve:[1,2],vector:1,veri:[0,2,4,6,8],vertic:5,view:3,vs:[2,5,6,7],w:[3,4,7],wa:[1,2],wai:[1,3],walk:6,want:[2,3,7],warn:[1,2,3,5,6,7,8],we:[0,1,2,3,5,6,7,8],weather:1,weight:[1,2,5],welcom:4,well:[2,3,5,6,8],were:1,what:[1,4,5,8],when:[1,3,5],where:[1,2,3,5],which:[1,2,3,5],whole:3,wide:[3,5],width:3,wild:5,window:3,window_half:3,window_valu:3,within:3,without:2,wonder:1,work:[1,3,4,5],would:[1,2,3],wrapper:3,write:[2,4,7],write_and_run:2,wrote:3,wt:1,wts_back:[2,5],wts_by_cut:5,wts_sig:[2,5],x:[1,2,3,8],x_1:1,x_2:1,x_entropi:[],x_i:1,x_valu:[2,3],x_values_end:2,xbin:[1,8],xlabel:[0,1,2,3,5,6,7,8],y:[6,7],ybin:[1,8],ylabel:[0,1,2,3,5,6,7],you:[1,2,3,4,8],your:1,yscale:[1,8],zero:[1,2,3,5,6,7,8]},titles:["The Simple Problem","Adding a cut in front of an NN","Cut Implementations","Handling Simple Predicate Push-down","Exploring Differentiable Programming","Using JAX","Gradient Descent","Using a ML-like Loss Function","Looking for the Signal with a NN"],titleterms:{"function":[2,3,5,7],The:0,ad:1,an:1,block:1,brute:0,build:[1,8],comparison:2,concaten:1,connect:8,cut:[1,2],data:3,deriv:3,descent:[6,7],differenti:4,doe:3,down:3,erf:3,error:[2,5],examin:[1,8],explor:4,forc:0,front:1,fulli:8,goal:4,gradient:[5,6,7],handl:3,heavisid:5,implement:2,jax:5,like:7,look:8,loop:[6,7],loss:7,ml:7,mlp:1,modul:1,multipl:1,need:3,network:[1,8],nn:[1,8],predic:3,problem:0,program:4,push:3,select:1,sigmoid:2,signal:8,simpl:[0,3,8],solut:0,test:1,train:[1,3,8],us:[5,7],what:3}})
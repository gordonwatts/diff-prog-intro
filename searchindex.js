Search.setIndex({docnames:["basic","cut_then_nn","dumb_data_source","intro","jax","jax_optimization","ml_loss","using_nn"],envversion:{"sphinx.domains.c":2,"sphinx.domains.changeset":1,"sphinx.domains.citation":1,"sphinx.domains.cpp":5,"sphinx.domains.index":1,"sphinx.domains.javascript":2,"sphinx.domains.math":2,"sphinx.domains.python":3,"sphinx.domains.rst":2,"sphinx.domains.std":2,"sphinx.ext.intersphinx":1,sphinx:56},filenames:["basic.ipynb","cut_then_nn.ipynb","dumb_data_source.ipynb","intro.md","jax.ipynb","jax_optimization.ipynb","ml_loss.ipynb","using_nn.ipynb"],objects:{},objnames:{},objtypes:{},terms:{"0":[0,1,2,4,5,6,7],"00":1,"0002":1,"0005":6,"03":[1,7],"0540237":1,"06":[1,5,7],"09":[1,7],"1":[0,1,2,4,5,6,7],"10":[0,1,4,5,6,7],"100":[0,1,2,4,5,6,7],"1000":[1,7],"101":1,"10k":1,"1130943":1,"1200":7,"12000":1,"1234":[1,7],"1400":7,"15":[1,7],"1600":7,"16000":1,"1800":7,"1d":[0,4],"2":[0,1,2,4,5,6,7],"20":[2,4,5],"200":[1,7],"2000":[1,7],"20000":1,"2082":6,"20k":1,"22":[0,1,4],"24000":1,"25":[1,7],"25000":1,"26":6,"28":1,"28000":1,"2d":[1,7],"3":[0,1,4,5,6,7],"30":[1,7],"300":1,"30k":7,"31":7,"32000":1,"34":1,"36000":1,"38":1,"4":[0,1,2,4,5],"40":[1,2],"400":[1,7],"4000":1,"40000":[1,7],"40k":1,"41":1,"439072":7,"439129":7,"439237":7,"439340":7,"439481":7,"439542":7,"439545":1,"439553":1,"439573":1,"439608":1,"439667":1,"439677":7,"439773":1,"439910":7,"439975":1,"44":[0,4],"440081":7,"440314":1,"440696":7,"440938":1,"442189":1,"448803":1,"448879":1,"448972":1,"449082":1,"449200":1,"449205":1,"449336":1,"449472":1,"449610":1,"449746":1,"449880":1,"45":[1,5],"450008":1,"450086":7,"47":7,"5":[1,2,5,7],"50":[1,5,6,7],"500":[1,7],"51615274":1,"535":4,"56":7,"6":[1,7],"600":[1,7],"62":[1,6],"624483346939087":5,"6565423":1,"66":1,"69":[1,7],"7":1,"70":[1,7],"700":1,"72":1,"737":[0,4],"74":0,"75":1,"8":0,"80":[1,7],"800":[1,7],"8000":1,"81":[1,7],"857177734375":6,"88":4,"89632797241211":5,"9":[1,7],"90":[0,6],"900":1,"91":7,"94":7,"97":1,"case":[1,2],"class":1,"do":[0,1,2,3,4,6,7],"final":[0,1,2,5,6],"float":[0,1,2,4,5,6],"function":[1,3,5],"import":[0,1,2,4,5,6,7],"long":1,"new":[1,5,6],"return":[0,1,2,4,5,6,7],"short":[1,4],"super":1,"try":[1,2,3,4],A:[0,6],And:[1,4,7],As:[1,2,7],At:[1,4],But:2,For:2,If:1,In:[1,2,4,6,7],It:[0,1,2],No:[1,2,4,5,6,7],Not:4,One:2,That:[1,2,4],The:[1,2,3,4,6,7],Then:2,There:2,To:[2,7],With:7,_:[1,2,4,5,6,7],__call__:1,__init__:1,_cut:[2,6],_initial_cut:1,_layer:1,abl:4,about:[1,2,3,4,7],abov:[1,2,4],absl:[1,2,4,5,6,7],actual:[1,2,3],ad:3,adam:[1,7],add:[1,4,7],after:2,algorithm:[1,5],align:2,all:[1,2,6],all_data:[1,7],all_truth:[1,7],allow:1,almost:[],along:[1,2],alpha:[0,1,7],also:[1,2,7],alwai:2,amount:2,an:[3,4],analysi:2,ani:[1,5],answer:6,anyth:[0,2],apart:1,appear:1,append:[5,6],appli:[1,2,7],apply_wt:4,ar:[0,1,2,3,4,5],aren:6,argmax:[0,4],around:[1,2,3,4,5],arrai:[0,2,4,5,6],asarrai:[1,2,4,7],ask:2,aspect:2,assert:1,assum:2,astyp:[1,7],auto:[2,3],automat:2,avoid:7,awai:1,ax1:[5,6],ax2:[5,6],axhlin:[1,2,4,5,6],axi:[1,5,6],axvlin:[0,1,4,6],b:[0,3,4,5,6],back:[0,1,2,4,5,6,7],background:[0,1,2,3,6,7],background_data:[1,7],bad:[1,7],bad_data:[1,7],basic:[1,3,5],becaus:1,been:7,befor:[1,2],behav:[4,5,6],behavior:7,below:[1,2,7],best:7,better:[2,4,5,6],beyond:1,big:6,bin:[0,1,7],bit:[1,2,5,7],black:[4,5,6],blown:2,blue:[5,6],book:3,both:[1,2,4],bottom:4,bring:1,broad:3,brute:3,buffer:2,bulk:1,bunch:3,c:[0,1,4,5,6],calc_valu:1,calcul:[0,1,2,4],call:1,can:[1,2,4,5,7],carefulli:[1,6],caus:[],central:2,chang:1,chapter:[0,1,2,6,7],characterist:4,check:1,choos:[1,6],circl:7,circumst:1,classif:6,classifi:[1,7],client:2,close:6,cm:[1,7],cmap:[1,7],code:[1,5,7],color:[0,1,2,4,5,6,7],combin:[1,6],comment:3,compar:[1,2,3],comparison:1,complet:6,compon:1,concat:1,concaten:[6,7],concatin:1,conclus:2,construct:[0,3],contain:4,contour:[1,7],convert:4,correct:[1,7],could:[1,2,7],count:[1,5,6,7],cpu:[1,2,4,5,6,7],creat:[0,6],cross:2,ctor:1,current:[2,6],curv:5,cut:[0,2,3,4,5,6,7],cut_data:2,cut_loss:[1,6],cut_range_valu:1,cut_valu:[0,1,2,4,5,6],cuts_initi:1,d:[1,6],d_erf_sig_sqrt_b:4,d_erf_valu:2,d_loss:2,d_my_erf:2,d_sig_sqrt_b:4,dash:[4,5,6],data:[1,3,4,7],data_back:[0,1,4,6,7],data_back_j:4,data_sig:[0,4,6],data_sig_j:4,dataset:[2,7],deal:[2,5],decent:[1,3],decid:[],declaremathoper:[],def:[0,1,2,4,5,6,7],defin:7,delta:[2,4],depend:[1,6],deriv:[1,4],descent:3,design:4,determin:[1,6],devicearrai:1,did:6,diff:[2,3],differ:1,differenti:[0,2],directli:1,discuss:1,displac:0,distanc:6,distinct:2,distribut:[0,2],do_sig_b_inf:1,doe:[3,4,5],doesn:[1,5],don:3,done:[1,5,7],down:[1,3],drawn:0,dtyp:1,dtype:1,dumb:2,dure:[2,6],e:2,each:[1,5],earlier:1,easi:1,effect:1,effici:1,either:[1,4],electron:2,element:1,els:1,end:[1,6],enough:4,epoch:[1,2,7],erf:[1,4,6,7],erf_max_valu:4,erf_s_sqrt_b:4,erf_sig_sqrt_b:4,erf_valu:2,erf_window_mask:2,error:[1,2],etc:5,evalu:[1,5],even:[1,2],everi:5,everyth:[1,2],exact:[4,5],exactli:[1,4],exampl:2,execut:2,expect:1,experi:6,explor:4,exponenti:2,extend:[1,7],extent:[1,7],f:[0,1,5,6],fact:[1,2,4],factor:[],fall:[1,2,4,5,6,7],fals:4,far:1,fascin:1,feed:[],feedforward:[1,7],fig:[5,6],figur:3,find:[4,5],fine:1,first:[1,4,7],fit:2,flat:1,float32:[1,7],follow:1,forc:3,forward:[0,1],found:[1,2,4,5,6,7],from:[0,1,2,4,5,6,7],front:[3,7],full:[1,2,7],full_loss:2,further:1,g:2,g_valu:[5,6],gaussian:0,gener:1,get:[1,2,6,7],get_paramet:1,gev:2,github:3,given:1,go:[1,2,4,5,7],goal:7,good:[1,4,7],good_data:[1,7],gotcha:4,gpu:[1,2,4,5,6,7],grad:[2,4,5,6],gradient:[1,2,3],graphic:[1,7],greater:[],green:[0,1,2,4,6,7],grind:1,ha:[1,2,4,6,7],had:1,hadn:1,haiku:[1,7],half:2,halt:1,hand:1,handl:3,happen:[1,2],hard:[3,7],harder:6,have:[1,2,3,4,5,6,7],he:[],head:1,heck:4,help:5,henc:[],hep:2,here:[1,2,4,5],hist2d:[1,7],hist:[0,1,7],hit:1,hk:[1,7],hl:2,how:[1,2,3,4,6],howev:[1,3,6],i:[0,1,3,7],i_background:1,i_sign:1,idea:5,ident:1,implement:[1,2,7],incorrect:1,increas:1,individu:1,infer:[1,2,7],infer_b_mlp:1,infer_b_sel:1,infer_background:[1,7],infer_s_mlp:1,infer_s_sel:1,infer_sign:[1,7],infin:1,info:[1,2,4,5,6,7],infrastructur:1,init:1,initi:1,initial_cut:1,input:1,instead:6,interact:2,interest:[0,1,2,7],ion:[0,1,2,4,5,6,7],iri:2,isn:[2,4],issu:[1,7],iter:[1,5,6],its:[1,2],itself:2,jax:[1,2,3,5,6,7],jax_help:[1,2,5,6,7],jnp:[1,2,4,5,6,7],just:[1,2,5,6,7],keep:[0,1,7],kei:[1,7],know:[1,2,3],knowledg:1,l:6,label:[0,1,5,6,7],labelcolor:[5,6],lambda:1,laptop:1,larg:2,last:[1,2],lastli:4,lax:[1,4],layer:[1,2,7],layer_output:1,lazi:1,lbl:1,learn:[1,2,3,5,6],learning_r:[1,5,6],legend:[0,1,7],len:[0,1,2,6,7],less:[],let:[0,1,2,4,5,6,7],level:[1,7],lhc:2,like:[1,2,3,5,7],likelihood:[5,6],limit:[4,5],line:[2,4],linestyl:[4,5,6],linewidth:[1,7],linspac:[0,1,2,4,5,6],list:1,littl:4,live:1,ll:[1,7],load:[1,2,7],loadtxt:2,local:5,locat:7,log:[1,2,6,7],look:[0,1,2,3,4,5,6],loop:[1,3],loss:[1,2,3,5],lot:[1,2],low:1,lower:4,m:[1,3],made:1,magic:0,mai:[1,2,4],make:[0,1,2,3,6,7],mask:2,masked_loss:2,masked_loss_deriv:2,masked_training_data:2,masked_training_truth:2,match:[2,4],math:0,matplotlib:[0,1,2,4,5,6,7],matter:1,max:[0,4],max_index:[0,4,6],maximum:5,me:3,mean:[1,2],meant:[1,7],median:1,memori:2,method:[0,1,4],mi:1,might:[1,2,3,5,7],mind:0,minim:[2,7],minima:5,minimz:1,minut:1,misclassifi:[1,7],ml:3,mlp:7,model:[1,7],model_mlp_onli:1,model_selection_onli:1,modifi:4,modul:7,moduleconcat:1,more:[1,2,3,4,5,6,7],most:1,move:[1,2,3,7],much:[2,3,6],multipli:1,multiply:1,multiplyrow:1,multivariate_norm:[1,7],must:2,my_erf:2,myself:3,n:[1,6],n_sig:0,name:[1,7],need:[1,3,4,5,7],neg:1,neglogloss:[1,7],net:[1,7],next:[0,1,6,7],nn:3,non:2,none:1,nope:4,normal:[6,7],note:[1,2,4],notebook:1,noth:[1,2],now:[1,4,5,6],np:[0,2],number:1,numpi:[0,1,2,3,4,5,6,7],observ:1,occur:[0,4],odd:1,off:[1,4],offset:7,often:2,ok:5,old:1,onc:5,one:[1,2,4,5,6],ones:[1,6,7],onli:[1,2],open:6,oper:[1,3],optax:[1,7],optim:[0,1,3,6,7],option:1,orang:[5,6],order:[1,5,6],other:[0,1],otherwis:1,our:[1,2,4,5,6],out:[1,2,3,4,5,6],output:1,output_s:[1,7],outsid:1,over:1,overlap:7,own:1,p:1,p_t:2,page:2,parallel:1,param:[1,7],paramet:1,part:[1,2],pass_back:0,past:1,pattern:1,per:[],perform:[1,2,6],perhap:[2,4],pick:1,pipe:2,place:[4,5],plain:1,plateau:1,plot:[0,1,2,4,5,6,7],plot_contour:[1,7],plot_in_and_out:1,plot_infer:[1,7],plot_it:1,plot_pr:7,plt:[0,1,2,4,5,6,7],pm:2,point:[2,4,6],possibl:4,pred:[1,7],predic:3,predict:[1,2,6,7],previou:1,previous:6,print:[0,1,4,5,6],prngkei:[1,7],probabl:4,problem:[1,3,4],prod:1,program:2,project:2,proper:1,properli:1,pull:[2,3],pump:2,push:[1,3],put:1,pyplot:[0,1,2,4,5,6,7],quit:7,r:[0,1,2,3,4,5,6],rainbow:[1,7],random:[1,6,7],rang:[0,1,5,6,7],rapidli:2,rate:5,rather:[1,6],raw:1,re:[5,7],reach:1,read:[2,3],real:6,realiti:1,realli:[1,2,3],reason:[1,5],reconstruct:2,red:[1,7],reduc:2,reject:1,reli:5,rememb:1,repeat:6,replac:3,repo:3,request:[2,3],requir:[1,2],rerun:[1,2,4,5,6,7],rest:6,result:[1,2,7],rf:[0,4],right:[1,2,4],rightarrow:2,rotat:[0,6],row:1,run:[4,5,6],run_ev:1,s:[0,1,3,4,5,6],s_sqrt_b:[0,4,6],sadli:5,sai:[1,2],same:[1,4,6,7],sampl:[0,1,4,6,7],save:2,scale:0,scan:0,scatter:[1,7],scheme:2,search:4,see:[1,4,6,7],seed:2,seem:2,seen:1,select:[0,2,3,7],select_model:1,select_param:1,selectioncut:1,self:1,sens:0,separ:[1,7],servicex:2,set:[1,2,4,5,6,7],set_ylabel:[5,6],shape:1,shift:1,ship:2,should:1,show:[0,1,2,4,5,6,7],shown:[1,7],shp:1,side:2,sig:0,sig_avg:[1,6,7],sig_sqrt_b:[0,4,5],sig_width:[1,6,7],sigmoid:[1,7],signal:[0,1,2,3,6],signal_data:[1,7],significantli:2,similar:1,simpl:[1,3,4,5,6],simpler:[2,7],simpli:5,simplist:5,simul:4,singl:[1,3],sit:1,size:[6,7],slightli:4,slower:1,small:[2,7],smarter:2,so:[0,1,2,3,5,6],softmax_cross_entropi:1,solut:2,solv:[0,2,3],some:[1,4],someth:[2,4],somewher:1,sort:3,sot:[],specifi:1,split:[1,7],spot:1,sqrt:[0,3,4,5,6],squar:[1,4],squeez:[1,7],standard:[1,3,6],start:[1,2,4,5,6],state:1,statement:5,step:[2,3],stradegi:1,straight:1,stroke:3,subplot:[5,6],substanti:7,subsystem:2,suggest:1,sum:[4,6],summari:1,suspect:7,sx:2,system:[2,3],t:[1,2,3,4,5,6],take:[1,3,4],taken:1,talk:3,teach:3,test:[2,7],test_pr:[1,7],testing_background:[1,7],testing_sign:[1,7],text:[0,6],textrm:1,tf_cpp_min_log_level:[1,2,4,5,6,7],than:[1,6,7],thei:[1,2],them:1,thi:[0,1,2,3,4,5,6,7],thing:[2,5],think:[0,1],through:2,thu:2,tick_param:[5,6],time:[1,5,7],titl:[1,7],togeth:[1,2],too:[2,7],tool:3,tougher:2,toward:1,tpu:[1,2,4,5,6,7],track:6,tradit:6,train:[5,6],trained_cut_valu:1,training_data:[1,2,6,7],training_truth:[1,2,6,7],transform:[1,7],transpos:[1,7],trend:1,tri:1,triangl:7,tricki:1,truth:[1,7],tune:4,tupl:1,turn:[1,4],twinx:[5,6],two:[0,1,2,4],type:1,undefin:4,under:1,understand:[2,3],underwai:2,up:[1,2,4,5,7],update_cut:[5,6],upper:4,us:[1,2,3,5,7],v:[1,2],valu:[0,1,2,4,5,6,7],varefulli:[],ve:1,vector:1,veri:[0,3,5,7],vertic:4,view:2,vs:[4,5,6],w:[2,3,6],wa:1,wai:[1,2],walk:5,want:[2,6],warn:[1,2,4,5,6,7],we:[0,1,2,4,5,6,7],weather:1,weight:[1,4],welcom:3,well:[2,4,5,7],were:1,what:[1,3,4,7],when:[1,2,4],where:[1,2,4],which:[1,2,4],whole:2,wide:[2,4],width:2,wild:4,window:2,window_half:2,window_valu:2,within:2,wonder:1,work:[1,2,3,4],would:[1,2],wrapper:2,write:[3,6],wrote:2,wt:1,wts_back:4,wts_by_cut:4,wts_sig:4,x:[1,2,7],x_1:1,x_2:1,x_i:1,x_valu:2,xbin:[1,7],xlabel:[0,1,2,4,5,6,7],y:[5,6],ybin:[1,7],ylabel:[0,1,2,4,5,6],you:[1,2,3,7],your:1,yscale:[1,7],zero:[1,2,4,5,6,7]},titles:["The Simple Problem","Adding a cut in front of an NN","Handling Simple Predicate Push-down","Exploring Differentiable Programming","Using JAX","Gradient Descent","Using a ML-like Loss Function","Looking for the Signal with a NN"],titleterms:{"function":[2,4,6],The:0,ad:1,an:1,block:1,brute:0,build:[1,7],concaten:1,connect:7,cut:1,data:2,deriv:2,descent:[5,6],differenti:3,doe:2,down:2,erf:2,error:4,examin:[1,7],explor:3,forc:0,front:1,fulli:7,goal:3,gradient:[4,5,6],handl:2,heavisid:4,jax:4,like:6,look:7,loop:[5,6],loss:6,ml:6,mlp:1,modul:1,multipl:1,need:2,network:[1,7],nn:[1,7],predic:2,problem:0,program:3,push:2,select:1,signal:7,simpl:[0,2,7],solut:0,test:1,train:[1,2,7],us:[4,6],what:2}})